#!/usr/bin/env python3

import sys, time, argparse, subprocess, os, signal, random, string
import itertools
from multiprocessing import Pool

Description = """
Creating a dataset of N individuals from the 1000 Genome Project
"""

#------------------------------------------------------------
# List of all the samples in phase 3
#
samples_ids = ["HG00174", "HG00179", "HG00181", "HG00148", "HG00150", "HG00155", "HG00117", "HG00124", "HG00129", "HG00186", "HG00232", "HG00237", "HG00131", "HG00136", "HG00143", "HG00097", "HG00100", "HG00105", "HG00112", "HG00403", "HG00408", "HG00410", "HG00357", "HG00364", "HG00369", "HG00371", "HG00256", "HG00263", "HG00116", "HG00268", "HG00123", "HG00244", "HG00128", "HG00249", "HG00159", "HG00251", "HG00173", "HG00270", "HG00178", "HG00275", "HG00180", "HG00282", "HG00130", "HG00319", "HG00135", "HG00321", "HG00142", "HG00326", "HG00104", "HG00338", "HG00109", "HG00345", "HG00111", "HG00376", "HG00147", "HG00383", "HG00154", "HG00096", "HG00542", "HG00337", "HG00554", "HG00344", "HG00559", "HG00349", "HG00561", "HG00351", "HG00566", "HG00356", "HG00578", "HG00243", "HG00580", "HG00248", "HG00453", "HG00250", "HG00458", "HG00318", "HG00465", "HG00320", "HG00472", "HG00325", "HG00422", "HG00332", "HG00427", "HG00255", "HG00446", "HG00262", "HG00585", "HG00267", "HG00592", "HG00185", "HG00597", "HG00231", "HG00236", "HG00306", "HG00629", "HG00313", "HG00631", "HG00274", "HG00530", "HG00281", "HG00535", "HG00375", "HG00612", "HG00382", "HG00477", "HG00368", "HG00718", "HG00565", "HG00732", "HG00577", "HG00737", "HG00584", "HG00693", "HG00421", "HG00698", "HG00438", "HG00655", "HG00445", "HG00662", "HG00553", "HG00674", "HG00558", "HG00636", "HG00560", "HG00650", "HG00589", "HG01071", "HG00591", "HG01083", "HG00596", "HG00701", "HG00452", "HG00706", "HG00457", "HG01064", "HG00464", "HG01069", "HG00407", "HG01052", "HG00419", "HG00864", "HG00609", "HG01261", "HG00611", "HG01273", "HG00476", "HG01278", "HG00534", "HG01280", "HG00717", "HG01204", "HG00729", "HG01242", "HG00731", "HG01247", "HG00736", "HG01103", "HG00623", "HG01108", "HG00628", "HG01110", "HG00630", "HG01134", "HG00654", "HG01139", "HG00673", "HG01141", "HG00685", "HG01088", "HG00692", "HG00743", "HG01095", "HG00844", "HG01184", "HG00851", "HG01189", "HG01049", "HG01191", "HG01051", "HG01254", "HG00700", "HG01259", "HG00705", "HG01172", "HG00635", "HG01177", "HG00642", "HG01122", "HG00983", "HG01362", "HG01114", "HG01367", "HG01119", "HG01374", "HG01121", "HG01348", "HG01126", "HG01350", "HG01133", "HG01355", "HG01164", "HG01413", "HG01169", "HG01432", "HG01171", "HG01437", "HG01176", "HG01444", "HG01183", "HG01393", "HG01188", "HG01398", "HG01190", "HG01305", "HG01312", "HG01056", "HG01456", "HG01063", "HG01068", "HG01343", "HG01070", "HG01379", "HG01087", "HG01538", "HG01094", "HG01552", "HG01099", "HG01571", "HG01075", "HG01499", "HG01082", "HG01502", "HG01102", "HG01507", "HG01107", "HG01519", "HG01138", "HG01521", "HG01140", "HG01526", "HG01241", "HG01595", "HG01347", "HG01603", "HG01354", "HG01463", "HG01359", "HG01468", "HG01405", "HG01494", "HG01412", "HG01583", "HG01431", "HG01253", "HG01258", "HG01260", "HG01514", "HG01323", "HG01709", "HG01342", "HG01711", "HG01272", "HG01747", "HG01277", "HG01615", "HG01284", "HG01622", "HG01311", "HG01627", "HG01378", "HG01773", "HG01385", "HG01778", "HG01361", "HG01780", "HG01366", "HG01608", "HG01392", "HG01610", "HG01696", "HG01498", "HG01704", "HG01501", "HG01672", "HG01506", "HG01677", "HG01518", "HG01684", "HG01520", "HG01761", "HG01525", "HG01766", "HG01479", "HG01874", "HG01879", "HG01486", "HG01881", "HG01455", "HG01886", "HG01462", "HG01893", "HG01532", "HG01848", "HG01537", "HG01850", "HG01513", "HG01855", "HG01443", "HG01817", "HG01474", "HG01843", "HG01493", "HG01797", "HG01800", "HG01599", "HG01805", "HG01602", "HG01812", "HG01619", "HG01785", "HG01621", "HG01862", "HG01626", "HG01867", "HG01708", "HG01968", "HG01710", "HG01970", "HG01746", "HG01975", "HG01551", "HG02012", "HG01556", "HG02017", "HG01633", "HG01951", "HG01669", "HG01956", "HG01671", "HG01920", "HG01676", "HG01925", "HG01607", "HG01898", "HG01614", "HG01918", "HG01683", "HG01932", "HG01695", "HG01937", "HG01703", "HG01944", "HG01784", "HG01949", "HG01789", "HG01982", "HG01791", "HG01987", "HG01772", "HG02106", "HG01777", "HG02113", "HG01816", "HG02120", "HG01842", "HG02024", "HG01796", "HG02029", "HG01804", "HG02031", "HG01859", "HG02137", "HG01861", "HG02144", "HG01809", "HG02067", "HG01811", "HG02074", "HG01866", "HG02079", "HG01873", "HG02081", "HG01765", "HG02048", "HG01847", "HG02050", "HG01979", "HG02086", "HG01981", "HG02132", "HG01986", "HG02055", "HG01878", "HG02238", "HG01880", "HG02240", "HG01885", "HG02252", "HG01897", "HG02257", "HG01912", "HG02271", "HG01917", "HG02219", "HG01943", "HG02221", "HG01948", "HG02283", "HG01950", "HG01967", "HG02182", "HG01974", "HG02187", "HG01936", "HG02233", "HG01924", "HG02151", "HG01892", "HG02156", "HG01955", "HG01998", "HG02004", "HG02009", "HG02303", "HG02011", "HG02308", "HG02054", "HG02353", "HG02059", "HG02061", "HG02360", "HG02085", "HG02409", "HG02105", "HG02428", "HG02023", "HG02315", "HG02028", "HG02322", "HG02030", "HG02389", "HG02078", "HG02391", "HG02080", "HG02372", "HG02073", "HG02377", "HG02016", "HG02334", "HG02035", "HG02339", "HG02047", "HG02384", "HG01993", "HG02396", "HG02148", "HG02555", "HG02150", "HG02562", "HG02155", "HG02129", "HG02492", "HG02131", "HG02497", "HG02136", "HG02574", "HG02505", "HG02220", "HG02512", "HG02225", "HG02478", "HG02232", "HG02480", "HG02237", "HG02485", "HG02256", "HG02143", "HG02536", "HG02181", "HG02461", "HG02186", "HG02275", "HG02586", "HG02179", "HG02442", "HG02408", "HG02699", "HG02410", "HG02702", "HG02427", "HG02649", "HG02299", "HG02687", "HG02302", "HG02694", "HG02307", "HG02613", "HG02388", "HG02620", "HG02390", "HG02651", "HG02395", "HG02656", "HG02282", "HG02287", "HG02675", "HG02364", "HG02601", "HG02371", "HG02682", "HG02314", "HG02321", "HG02383", "HG02790", "HG02439", "HG02345", "HG02783", "HG02554", "HG02769", "HG02561", "HG02771", "HG02491", "HG02496", "HG02757", "HG02477", "HG02808", "HG02484", "HG02810", "HG02489", "HG02726", "HG02511", "HG02733", "HG02523", "HG02721", "HG02573", "HG02839", "HG02580", "HG02597", "HG02891", "HG02600", "HG02896", "HG02465", "HG02923", "HG02585", "HG02860", "HG02643", "HG02973", "HG02648", "HG02679", "HG02884", "HG02681", "HG02686", "HG03015", "HG02662", "HG03022", "HG02667", "HG02947", "HG02624", "HG02629", "HG02605", "HG02725", "HG03027", "HG02655", "HG02698", "HG03039", "HG03109", "HG02763", "HG03111", "HG02768", "HG02775", "HG03058", "HG02787", "HG03060", "HG02799", "HG03130", "HG02819", "HG03135", "HG03046", "HG02840", "HG03096", "HG02737", "HG02756", "HG03077", "HG02888", "HG03084", "HG02890", "HG03091", "HG02814", "HG02852", "HG03072", "HG02807", "HG03123", "HG03212", "HG03224", "HG03007", "HG03298", "HG02895", "HG03301", "HG02922", "HG03229", "HG03040", "HG03045", "HG03267", "HG02946", "HG03279", "HG02953", "HG03159", "HG03019", "HG03021", "HG03166", "HG02941", "HG02977", "HG03394", "HG03139", "HG03351", "HG03363", "HG03160", "HG03452", "HG03064", "HG03457", "HG03069", "HG03076", "HG03445", "HG03108", "HG03313", "HG03115", "HG03052", "HG03370", "HG03057", "HG03382", "HG03095", "HG03419", "HG03103", "HG03433", "HG03127", "HG03488", "HG03172", "HG03490", "HG03088", "HG03577", "HG03247", "HG03584", "HG03259", "HG03589", "HG03189", "HG03464", "HG03469", "HG03196", "HG03209", "HG03539", "HG03228", "HG03558", "HG03297", "HG03604", "HG03300", "HG03611", "HG03616", "HG03343", "HG03515", "HG03235", "HG03476", "HG03565", "HG03280", "HG03572", "HG03642", "HG03437", "HG03697", "HG03449", "HG03451", "HG03673", "HG03514", "HG03680", "HG03736", "HG03521", "HG03743", "HG03750", "HG03705", "HG03401", "HG03685", "HG03692", "HG03499", "HG03729", "HG03731", "HG03470", "HG03717", "HG03367", "HG03755", "HG03432", "HG03762", "HG03793", "HG03538", "HG03774", "HG03557", "HG03779", "HG03646", "HG03781", "HG03653", "HG03660", "HG03832", "HG03767", "HG03595", "HG03837", "HG03603", "HG03844", "HG03786", "HG03571", "HG03882", "HG03583", "HG03887", "HG03634", "HG03894", "HG03615", "HG03907", "HG03672", "HG03914", "HG03919", "HG03926", "HG03684", "HG03849", "HG03689", "HG03851", "HG03691", "HG03856", "HG03754", "HG03899", "HG03902", "HG03940", "HG03773", "HG03870", "HG03875", "HG03709", "HG03863", "HG03711", "HG03868", "HG03716", "HG03945", "HG03696", "HG04056", "HG03778", "HG04063", "HG03780", "HG04070", "HG04075", "HG03730", "HG04094", "HG03742", "HG04099", "HG03824", "HG03995", "HG03829", "HG04001", "HG04006", "HG03805", "HG03976", "HG03812", "HG03874", "HG03990", "HG04140", "HG03800", "HG04025", "HG03848", "HG04037", "HG03850", "HG04018", "HG03862", "HG04020", "HG03867", "HG03969", "HG03785", "HG03971", "HG03792", "HG04107", "HG03817", "HG03836", "NA07051", "HG03944", "NA07056", "HG03949", "NA07347", "HG03951", "NA06995", "HG03898", "NA07037", "HG04210", "HG03920", "HG03925", "HG04222", "HG03886", "HG04227", "HG03913", "HG04183", "HG03937", "HG04188", "HG03963", "HG04152", "HG03968", "HG03999", "HG04164", "HG04171", "HG04106", "HG04176", "HG04118", "HG04195", "HG04239", "NA10864", "HG04029", "NA11829", "NA11831", "NA11843", "HG04062", "NA11881", "NA11893", "NA11918", "NA11920", "HG04156", "NA11932", "HG04093", "NA11994", "HG04098", "NA12144", "HG04144", "NA12156", "HG04017", "NA12264", "NA12005", "NA12043", "NA06994", "NA12283", "NA07000", "NA12341", "NA07029", "NA12485", "NA07031", "NA12707", "NA07048", "NA12740", "NA07055", "NA10840", "NA07346", "NA10845", "HG04194", "NA10852", "NA10857", "HG04202", "NA10838", "HG04182", "NA18508", "NA18510", "HG04238", "NA18515", "NA18522", "NA10837", "NA12776", "HG04219", "NA12815", "HG04214", "NA12827", "NA07435", "NA12877", "NA12275", "NA12889", "NA12282", "NA12891", "NA12287", "NA18553", "NA12340", "NA18558", "NA11892", "NA18560", "NA11917", "NA12865", "NA11931", "NA12872", "NA11993", "NA18488", "NA12155", "NA18503", "NA12249", "NA18539", "NA12489", "NA18541", "NA12718", "NA18546", "NA12376", "NA18527", "NA12383", "NA18534", "NA10863", "NA12752", "NA11830", "NA18868", "NA12004", "NA18870", "NA10851", "NA18875", "NA10856", "NA18565", "NA12749", "NA18572", "NA12751", "NA18577", "NA12763", "NA18591", "NA12775", "NA18623", "NA18487", "NA18628", "NA18499", "NA18856", "NA18502", "NA18863", "NA18507", "NA18611", "NA18519", "NA18616", "NA18521", "NA18596", "NA18552", "NA18609", "NA18557", "NA18630", "NA18564", "NA18635", "NA12802", "NA18642", "NA12814", "NA18647", "NA12890", "NA18748", "NA18538", "NA18933", "NA18545", "NA18940", "NA18526", "NA18983", "NA18533", "NA18988", "NA12864", "NA18990", "NA18595", "NA18907", "NA18603", "NA18995", "NA18608", "NA19001", "NA18867", "NA18964", "NA18874", "NA18969", "NA18622", "NA18971", "NA18627", "NA18976", "NA18571", "NA18952", "NA18576", "NA18957", "NA18634", "NA18945", "NA18639", "NA18914", "NA18610", "NA19102", "NA18615", "NA19107", "NA18641", "NA19114", "NA18646", "NA19037", "NA18747", "NA19044", "NA18855", "NA19119", "NA18862", "NA19121", "NA18879", "NA19094", "NA18881", "NA19099", "NA18906", "NA19068", "NA18994", "NA19070", "NA18999", "NA19075", "NA19000", "NA19056", "NA18963", "NA19063", "NA18968", "NA19082", "NA18970", "NA19087", "NA18944", "NA19020", "NA18949", "NA19025", "NA18951", "NA19006", "NA18982", "NA19239", "NA18987", "NA19258", "NA18975", "NA19309", "NA18956", "NA19311", "NA18913", "NA19138", "NA18925", "NA19140", "NA19118", "NA19145", "NA19120", "NA19203", "NA19132", "NA19208", "NA19137", "NA19210", "NA19093", "NA19176", "NA19098", "NA19190", "NA19101", "NA19195", "NA19113", "NA19152", "NA19079", "NA19171", "NA19081", "NA19215", "NA19086", "NA19222", "NA19017", "NA19328", "NA19024", "NA19347", "NA19031", "NA19316", "NA19067", "NA19323", "NA19074", "NA19373", "NA19005", "NA19378", "NA19012", "NA19380", "NA19055", "NA19474", "NA19062", "NA19652", "NA19036", "NA19436", "NA19043", "NA19443", "NA19238", "NA19657", "NA19240", "NA19664", "NA19252", "NA19385", "NA19257", "NA19397", "NA19308", "NA19429", "NA19310", "NA19431", "NA19199", "NA19448", "NA19202", "NA19455", "NA19207", "NA19462", "NA19214", "NA19467", "NA19221", "NA19359", "NA19226", "NA19789", "NA19327", "NA19796", "NA19334", "NA19828", "NA19346", "NA19734", "NA19144", "NA19741", "NA19149", "NA19746", "NA19151", "NA19669", "NA19175", "NA19671", "NA19360", "NA19676", "NA19372", "NA19683", "NA19315", "NA19703", "NA19473", "NA19753", "NA19625", "NA19758", "NA19649", "NA19722", "NA19651", "NA19727", "NA19404", "NA19777", "NA19428", "NA19784", "NA19430", "NA19760", "NA19384", "NA19772", "NA19391", "NA19708", "NA19396", "NA20363", "NA19670", "NA20414", "NA19675", "NA20503", "NA19656", "NA20128", "NA19663", "NA20274", "NA19454", "NA20279", "NA19461", "NA20281", "NA19435", "NA20349", "NA19377", "NA20351", "NA19466", "NA20356", "NA19707", "NA20318", "NA19714", "NA20320", "NA19719", "NA20332", "NA19788", "NA20298", "NA19790", "NA20301", "NA19795", "NA20313", "NA19834", "NA19835", "NA19904", "NA19900", "NA19909", "NA19733", "NA20508", "NA19738", "NA20510", "NA19740", "NA20515", "NA19682", "NA19917", "NA19702", "NA19924", "NA19764", "NA20337", "NA19771", "NA20344", "NA19721", "NA20767", "NA19726", "NA20774", "NA19776", "NA20786", "NA19783", "NA20806", "NA19752", "NA20813", "NA19757", "NA20534", "NA20362", "NA20539", "NA20413", "NA20798", "NA20502", "NA20801", "NA19985", "NA20541", "NA20127", "NA20589", "NA20278", "NA20522", "NA20297", "NA20527", "NA20300", "NA20849", "NA20312", "NA20851", "NA20317", "NA20856", "NA20348", "NA20755", "NA20350", "NA20762", "NA20355", "NA20818", "NA19916", "NA20832", "NA19923", "NA21114", "NA20507", "NA21119", "NA20514", "NA21121", "NA20336", "NA20899", "NA20285", "NA20902", "NA20292", "NA20907", "NA20343", "NA20863", "NA20792", "NA20868", "NA20797", "NA21094", "NA20800", "NA21099", "NA20519", "NA21102", "NA20521", "NA20870", "NA20526", "NA20875", "NA20766", "NA20882", "NA20773", "NA20887", "NA20778", "NA21087", "NA20785", "NA20894", "NA20533", "NA21107", "NA20538", "NA20540", "NA20754", "NA20759", "NA20761", "NA20805", "NA20812", "NA20588", "NA20850", "NA20829", "NA20831", "NA20881", "NA20886", "NA21126", "NA20874", "NA21133", "NA20879", "NA21093", "NA21098", "NA21101", "NA21113", "NA21118", "NA21120", "NA20901", "NA20906", "NA20862", "NA20867", "NA20893", "NA20898", "NA21086", "NA21106", "NA21137", "NA21144", "NA21125", "HG00114", "HG00119", "HG00121", "HG00126", "HG00133", "HG00138", "HG00140", "HG00102", "HG00107", "HG00099", "HG00183", "HG00188", "HG00190", "HG00234", "HG00284", "HG00304", "HG00309", "HG00311", "HG00253", "HG00258", "HG00260", "HG00265", "HG00157", "HG00171", "HG00176", "HG00323", "HG00328", "HG00330", "HG00239", "HG00246", "HG00335", "HG00342", "HG00272", "HG00277", "HG00145", "HG00152", "HG00513", "HG00525", "HG00532", "HG00537", "HG00544", "HG00551", "HG00556", "HG00474", "HG00479", "HG00501", "HG00429", "HG00436", "HG00443", "HG00448", "HG00450", "HG00373", "HG00378", "HG00380", "HG00359", "HG00361", "HG00366", "HG00405", "HG00582", "HG00599", "HG00607", "HG00614", "HG00619", "HG00621", "HG00652", "HG00657", "HG00132", "HG00664", "HG00137", "HG00671", "HG00144", "HG00118", "HG00683", "HG00120", "HG00690", "HG00125", "HG00101", "HG00638", "HG00106", "HG00640", "HG00113", "HG00703", "HG00149", "HG00708", "HG00151", "HG00739", "HG00156", "HG00741", "HG00098", "HG00626", "HG00734", "HG00594", "HG01150", "HG01162", "HG01167", "HG00358", "HG01174", "HG00360", "HG01054", "HG00365", "HG01061", "HG00372", "HG01066", "HG00288", "HG01131", "HG00290", "HG01136", "HG01148", "HG00308", "HG01085", "HG00310", "HG01092", "HG00315", "HG01097", "HG00339", "HG01028", "HG00341", "HG01047", "HG00346", "HG01112", "HG00353", "HG01124", "HG00257", "HG01073", "HG00264", "HG01080", "HG00269", "HG01100", "HG00187", "HG01105", "HG00233", "HG00866", "HG00238", "HG01249", "HG00240", "HG01251", "HG00245", "HG01256", "HG00252", "HG01376", "HG00327", "HG01383", "HG00334", "HG01390", "HG00271", "HG01345", "HG00276", "HG01352", "HG00182", "HG01357", "HG00478", "HG01198", "HG00480", "HG01206", "HG00500", "HG00512", "HG01369", "HG00524", "HG01275", "HG00531", "HG01302", "HG00536", "HG01326", "HG00423", "HG01395", "HG00428", "HG01496", "HG00442", "HG01504", "HG00447", "HG01489", "HG00459", "HG01491", "HG00473", "HG01439", "HG00404", "HG01441", "HG00409", "HG01516", "HG01523", "HG00567", "HG01509", "HG00579", "HG01511", "HG00581", "HG01403", "HG00543", "HG00555", "HG01465", "HG00593", "HG00598", "HG00377", "HG00384", "HG01597", "HG00699", "HG01600", "HG00702", "HG01679", "HG00707", "HG01681", "HG00656", "HG01686", "HG00663", "HG01629", "HG00733", "HG01631", "HG00613", "HG01667", "HG00620", "HG01573", "HG00637", "HG01578", "HG00651", "HG01617", "HG00625", "HG01624", "HG00632", "HG01528", "HG00675", "HG01530", "HG00694", "HG01605", "HG00738", "HG01612", "HG00740", "HG01566", "HG00978", "HG01674", "HG01104", "HG01770", "HG01109", "HG01775", "HG01111", "HG01763", "HG01135", "HG01768", "HG01142", "HG01794", "HG01161", "HG01799", "HG01072", "HG01802", "HG01077", "HG01807", "HG01084", "HG01756", "HG01178", "HG01840", "HG01192", "HG01698", "HG01197", "HG01701", "HG01046", "HG01782", "HG00158", "HG01053", "HG00160", "HG01058", "HG01706", "HG00177", "HG01060", "HG01934", "HG00134", "HG01089", "HG01939", "HG00139", "HG01096", "HG01941", "HG00141", "HG01946", "HG00115", "HG01130", "HG01922", "HG00122", "HG01173", "HG01927", "HG00127", "HG01200", "HG01895", "HG00242", "HG01205", "HG01915", "HG00247", "HG01243", "HG01888", "HG00146", "HG01248", "HG01890", "HG00153", "HG01349", "HG01857", "HG00103", "HG01351", "HG01864", "HG00108", "HG01356", "HG01845", "HG00110", "HG01274", "HG01852", "HG00189", "HG01279", "HG01869", "HG00235", "HG01281", "HG01871", "HG01325", "HG01883", "HG00420", "HG01344", "HG01953", "HG00437", "HG01250", "HG01958", "HG00444", "HG01255", "HG01960", "HG00254", "HG02014", "HG00259", "HG01402", "HG02019", "HG00261", "HG01286", "HG01989", "HG00266", "HG01991", "HG00406", "HG01375", "HG02052", "HG00418", "HG01363", "HG02057", "HG00355", "HG01488", "HG02021", "HG00362", "HG01490", "HG02026", "HG00367", "HG01495", "HG01977", "HG00324", "HG01438", "HG01984", "HG00329", "HG01440", "HG01965", "HG00331", "HG01972", "HG00273", "HG01503", "HG02002", "HG00278", "HG01515", "HG02040", "HG00280", "HG01522", "HG02083", "HG00336", "HG01414", "HG02088", "HG00343", "HG02090", "HG00350", "HG01464", "HG02095", "HG00379", "HG02122", "HG00381", "HG01508", "HG02127", "HG00285", "HG01510", "HG02134", "HG00312", "HG02146", "HG00514", "HG01457", "HG02153", "HG00526", "HG02064", "HG00533", "HG01577", "HG02069", "HG00538", "HG01589", "HG02071", "HG00552", "HG01596", "HG02076", "HG00557", "HG01604", "HG02139", "HG00653", "HG01565", "HG02141", "HG00658", "HG01572", "HG02184", "HG00672", "HG01680", "HG02189", "HG00583", "HG01685", "HG02165", "HG00590", "HG01616", "HG02108", "HG00595", "HG01623", "HG02259", "HG00634", "HG01673", "HG02261", "HG00639", "HG01678", "HG02266", "HG00641", "HG01628", "HG02280", "HG00449", "HG01630", "HG02285", "HG00451", "HG01527", "HG02312", "HG00463", "HG01609", "HG02317", "HG00608", "HG01611", "HG02292", "HG00610", "HG01774", "HG02300", "HG00615", "HG01779", "HG02273", "HG00475", "HG01781", "HG02278", "HG00502", "HG01697", "HG02230", "HG00622", "HG01700", "HG02235", "HG00627", "HG01755", "HG02223", "HG00867", "HG01762", "HG02343", "HG00879", "HG01705", "HG00881", "HG01748", "HG02451", "HG00956", "HG01798", "HG00982", "HG01801", "HG02470", "HG00684", "HG01806", "HG02494", "HG00689", "HG01813", "HG02420", "HG00691", "HG01786", "HG02425", "HG01029", "HG01767", "HG02379", "HG01031", "HG01844", "HG02381", "HG01048", "HG01933", "HG02398", "HG01050", "HG01938", "HG02401", "HG00716", "HG01940", "HG02406", "HG00728", "HG01914", "HG02348", "HG01919", "HG02355", "HG00735", "HG01921", "HG02386", "HG01055", "HG01926", "HG02449", "HG01062", "HG01887", "HG02367", "HG01067", "HG01894", "HG02374", "HG01074", "HG01945", "HG02603", "HG01079", "HG01868", "HG02610", "HG01081", "HG01870", "HG00742", "HG01849", "HG02502", "HG00759", "HG01851", "HG02514", "HG00766", "HG01882", "HG02521", "HG00704", "HG01863", "HG02588", "HG00709", "HG02013", "HG01086", "HG02018", "HG02595", "HG01098", "HG02020", "HG01101", "HG02032", "HG02545", "HG01106", "HG02049", "HG01168", "HG02051", "HG02571", "HG01170", "HG01969", "HG01175", "HG01971", "HG02634", "HG01269", "HG01976", "HG02583", "HG01271", "HG01988", "HG02646", "HG01276", "HG01990", "HG02557", "HG01113", "HG02689", "HG01125", "HG02025", "HG02691", "HG01252", "HG01983", "HG02696", "HG01257", "HG02006", "HG02735", "HG01137", "HG01952", "HG02759", "HG01149", "HG02056", "HG01182", "HG02107", "HG02684", "HG01187", "HG02121", "HG01303", "HG02126", "HG02658", "HG01308", "HG02138", "HG02716", "HG01199", "HG02140", "HG02145", "HG02728", "HG02188", "HG02660", "HG01334", "HG02190", "HG01341", "HG02215", "HG01372", "HG02075", "HG01377", "HG02082", "HG02778", "HG01384", "HG02068", "HG02780", "HG01389", "HG02070", "HG02785", "HG01447", "HG02087", "HG02102", "HG02879", "HG01459", "HG02164", "HG02881", "HG01461", "HG01358", "HG02817", "HG01360", "HG02133", "HG01365", "HG02152", "HG02805", "HG01391", "HG02258", "HG02836", "HG01396", "HG02260", "HG02855", "HG01346", "HG02265", "HG02792", "HG01353", "HG02272", "HG02944", "HG01435", "HG02284", "HG01442", "HG02291", "HG03074", "HG01466", "HG02239", "HG03079", "HG02253", "HG03081", "HG02309", "HG03086", "HG02316", "HG01593", "HG02277", "HG03055", "HG01598", "HG02323", "HG03024", "HG01601", "HG02330", "HG01497", "HG02304", "HG03012", "HG01500", "HG02234", "HG01505", "HG02222", "HG02968", "HG01550", "HG02479", "HG02970", "HG01567", "HG02481", "HG02982", "HG01529", "HG02486", "HG03048", "HG01531", "HG02429", "HG01536", "HG02436", "HG01579", "HG02450", "HG03163", "HG01586", "HG02455", "HG03168", "HG01517", "HG02462", "HG03199", "HG01524", "HG02493", "HG03202", "HG02501", "HG03118", "HG01485", "HG02380", "HG03120", "HG01492", "HG02385", "HG01512", "HG02373", "HG03175", "HG01613", "HG02397", "HG01618", "HG03132", "HG01620", "HG02392", "HG01625", "HG01682", "HG02594", "HG01687", "HG01694", "HG02602", "HG01699", "HG02568", "HG03238", "HG01702", "HG02570", "HG03240", "HG01670", "HG01675", "HG03271", "HG01632", "HG02537", "HG03303", "HG01668", "HG02549", "HG01606", "HG03372", "HG01707", "HG02582", "HG03295", "HG01757", "HG02621", "HG02513", "HG01846", "HG02614", "HG03391", "HG01853", "HG02645", "HG01790", "HG02688", "HG01795", "HG02690", "HG03473", "HG01771", "HG02727", "HG03478", "HG01776", "HG02734", "HG01815", "HG02652", "HG03485", "HG01841", "HG02657", "HG01858", "HG02703", "HG03428", "HG01860", "HG02715", "HG03461", "HG01808", "HG01810", "HG02760", "HG03517", "HG01865", "HG02772", "HG03567", "HG01872", "HG02722", "HG03442", "HG01783", "HG02676", "HG03548", "HG01884", "HG01978", "HG01980", "HG02943", "HG03492", "HG01985", "HG02804", "HG03644", "HG01954", "HG03649", "HG01959", "HG02811", "HG01961", "HG02854", "HG01942", "HG02861", "HG01947", "HG02789", "HG01923", "HG02791", "HG03625", "HG01928", "HG02878", "HG03694", "HG01896", "HG01916", "HG02816", "HG03663", "HG01889", "HG02784", "HG03668", "HG01891", "HG02885", "HG03593", "HG01935", "HG03598", "HG01992", "HG03702", "HG01973", "HG03078", "HG02084", "HG02089", "HG03085", "HG03687", "HG02091", "HG02974", "HG02104", "HG02979", "HG01997", "HG02981", "HG03606", "HG02003", "HG03054", "HG03733", "HG02008", "HG03738", "HG02010", "HG03061", "HG03740", "HG02053", "HG03028", "HG03745", "HG02058", "HG02060", "HG03066", "HG03788", "HG02111", "HG03073", "HG03790", "HG02116", "HG03016", "HG02072", "HG03771", "HG02046", "HG03009", "HG03803", "HG02027", "HG03808", "HG02077", "HG03815", "HG02015", "HG03097", "HG03822", "HG02147", "HG03100", "HG03714", "HG02154", "HG03105", "HG02128", "HG03129", "HG03752", "HG02130", "HG03757", "HG02135", "HG03136", "HG02250", "HG03193", "HG02255", "HG03198", "HG03896", "HG02229", "HG03117", "HG02231", "HG03124", "HG03928", "HG02236", "HG03162", "HG02166", "HG03237", "HG03911", "HG02178", "HG03112", "HG03916", "HG03884", "HG02224", "HG03858", "HG02262", "HG03225", "HG03872", "HG03369", "HG03846", "HG02180", "HG02185", "HG03376", "HG03973", "HG02142", "HG03978", "HG02293", "HG03388", "HG03985", "HG02298", "HG02301", "HG03268", "HG03947", "HG02281", "HG03270", "HG02286", "HG03294", "HG04003", "HG02351", "HG02356", "HG03410", "HG04060", "HG02274", "HG03352", "HG04015", "HG02279", "HG03439", "HG04022", "HG02363", "HG03446", "HG04039", "HG02375", "HG04096", "HG02387", "HG02394", "HG02325", "HG02332", "HG03491", "HG04229", "HG02337", "HG03511", "HG02318", "NA06985", "HG02382", "HG03458", "HG04159", "HG02464", "HG03460", "HG04161", "HG02508", "HG03578", "HG04173", "HG02522", "HG03585", "HG04180", "HG02490", "HG03547", "HG04185", "HG03559", "HG04200", "HG02399", "HG04212", "HG02402", "HG03484", "HG02407", "HG02541", "HG03472", "NA06997", "HG02546", "HG03600", "NA07022", "HG02558", "HG02471", "NA07034", "HG02476", "HG03667", "HG02433", "HG03679", "NA12273", "HG02445", "HG03681", "NA12329", "HG02419", "HG03693", "NA12336", "HG02678", "HG03698", "NA12343", "NA12348", "HG02685", "HG03624", "NA12386", "HG02661", "HG03629", "NA10861", "HG02666", "HG03631", "NA11840", "HG02604", "HG03713", "NA10842", "HG02611", "HG03718", "NA10847", "HG02623", "HG03720", "NA12045", "HG02628", "HG03636", "NA07349", "HG03643", "NA10854", "HG02635", "HG03706", "NA10859", "HG02642", "HG03686", "NA10830", "NA10835", "NA12057", "HG02577", "NA12146", "HG02654", "NA12778", "HG02659", "NA12812", "HG02589", "HG03802", "NA12817", "HG03756", "NA12829", "NA12843", "HG03775", "NA12413", "HG02724", "HG03782", "NA12716", "HG02793", "HG03814", "NA12761", "HG02798", "HG03821", "NA12766", "HG03770", "NA18505", "HG02774", "HG03744", "NA18517", "HG03787", "NA18536", "NA18543", "HG02786", "NA18548", "HG02729", "NA12874", "HG02731", "HG03908", "NA18485", "HG03910", "NA18497", "HG02697", "NA18500", "HG02700", "HG03869", "NA18531", "HG02736", "HG03871", "NA18853", "NA18858", "HG02870", "HG03826", "NA18860", "HG02882", "HG03833", "NA18550", "HG02820", "HG03888", "NA18555", "HG02837", "HG03890", "NA18562", "HG03895", "NA18567", "HG03922", "NA18574", "HG02971", "NA18579", "HG02851", "HG03838", "NA18593", "NA18606", "HG02813", "HG03857", "NA18632", "HG03864", "NA18637", "HG03845", "NA18620", "HG02952", "NA18625", "HG02887", "HG03934", "NA18745", "HG02976", "NA18757", "HG02938", "HG03941", "NA18795", "HG02983", "HG03977", "NA18613", "HG03006", "HG03989", "NA18618", "HG03991", "NA18644", "HG03114", "HG04038", "NA18740", "HG03025", "NA18911", "HG03049", "HG03960", "NA18916", "HG03063", "HG03965", "NA18923", "HG03099", "NA18865", "HG03018", "HG04026", "NA18872", "HG03082", "HG04033", "NA18877", "HG04076", "NA18954", "HG03241", "HG04090", "NA18959", "HG03246", "HG04002", "NA18961", "HG03258", "HG04014", "NA18973", "HG03953", "NA18978", "HG03169", "HG04019", "NA18980", "HG03171", "NA06984", "NA18909", "NA06989", "NA18942", "HG03234", "NA06991", "NA18947", "HG03239", "HG04216", "NA18930", "HG03126", "NA18935", "HG03133", "HG04235", "NA18985", "HG03190", "NA18966", "HG03195", "HG04209", "NA19089", "HG04211", "NA19091", "HG03157", "HG04134", "NA19096", "HG04141", "NA19077", "HG03121", "HG04146", "NA19084", "HG04177", "NA18992", "NA18997", "HG03378", "HG04189", "NA19065", "HG03380", "HG04153", "NA19072", "HG03385", "HG04158", "NA19058", "HG03366", "NA19060", "NA19003", "HG03311", "NA19010", "HG03342", "NA19027", "HG03304", "NA19041", "NA11995", "NA19046", "HG03265", "NA12006", "NA19104", "NA12044", "NA19109", "HG03291", "NA12056", "NA19154", "NA12145", "NA19159", "HG03354", "NA12234", "NA19161", "NA12239", "NA19166", "HG03397", "NA12272", "NA19173", "NA11894", "NA19116", "HG03575", "NA11919", "NA19123", "HG03582", "NA11933", "NA19128", "NA10865", "NA19130", "NA11832", "NA19197", "HG03518", "NA11882", "NA19200", "HG03520", "NA12335", "NA19205", "NA12342", "NA19236", "HG03556", "NA10839", "NA19248", "NA10846", "NA19142", "HG03479", "NA07045", "NA19147", "HG03436", "NA07348", "NA19185", "NA07014", "NA19318", "HG03455", "NA07019", "NA19320", "HG03563", "NA10853", "NA19313", "HG03486", "NA10860", "NA19224", "NA12828", "NA19654", "NA12830", "NA19659", "HG03619", "NA12842", "NA19661", "NA12873", "NA19438", "NA12878", "NA19440", "HG03633", "NA12892", "NA19445", "HG03645", "NA18484", "NA19375", "HG03652", "NA18509", "NA19382", "NA18511", "NA19469", "NA18516", "NA19471", "NA18523", "NA19452", "HG03690", "NA12347", "NA19457", "HG03594", "NA12400", "NA19399", "NA12753", "NA19332", "NA12760", "NA19351", "HG03703", "NA18489", "NA19394", "HG03708", "NA18504", "NA19678", "NA18528", "NA19680", "HG03640", "NA18530", "NA19685", "HG03607", "NA18535", "NA19700", "HG03695", "NA12777", "NA19705", "NA12708", "NA19712", "NA12739", "NA19717", "HG03809", "NA18749", "NA19779", "NA18794", "NA19781", "HG03765", "NA18852", "NA19786", "HG03772", "NA18566", "NA19748", "HG03722", "NA18573", "NA19750", "HG03727", "NA18592", "NA19755", "NA18629", "HG03715", "NA18631", "NA19818", "HG03796", "NA18636", "NA19762", "HG03753", "NA18597", "NA19774", "HG03760", "NA18605", "NA19724", "HG03784", "NA18542", "NA19729", "HG03789", "NA18547", "NA19902", "HG03741", "NA18559", "NA19914", "HG03746", "NA18561", "NA19731", "HG03777", "NA18612", "NA20339", "HG03897", "NA18617", "NA20341", "HG03900", "NA18643", "NA20346", "HG03905", "NA18648", "NA20322", "NA18624", "NA20334", "HG03823", "NA18934", "NA20505", "HG03917", "NA18939", "NA20512", "NA18941", "NA20517", "HG03830", "NA18869", "NA19983", "HG03885", "NA18871", "NA20276", "HG03861", "NA18876", "NA19919", "HG03866", "NA18908", "NA19921", "NA18910", "NA20288", "HG03854", "NA18857", "NA20290", "HG03873", "NA18864", "NA20358", "NA18972", "NA20360", "NA18977", "NA20295", "HG03943", "NA18953", "NA20764", "HG03948", "NA18960", "NA20769", "HG03950", "NA18965", "NA20771", "NA18946", "NA20783", "HG03931", "NA18915", "NA20808", "HG04054", "NA19088", "NA20810", "HG04059", "NA19090", "NA20815", "HG04061", "NA19095", "NA20790", "HG03955", "NA19002", "NA20795", "HG03967", "NA19007", "NA20803", "HG04023", "NA18984", "NA20543", "HG04035", "NA18989", "NA20581", "HG03974", "NA19057", "NA20586", "HG03986", "NA19064", "NA20524", "HG04042", "NA19019", "NA20529", "HG04047", "NA19026", "NA20752", "HG04080", "NA19083", "NA20757", "HG03998", "NA19076", "NA20531", "NA18991", "NA20536", "NA06986", "NA19038", "NA20846", "NA19177", "NA20853", "NA19184", "NA20822", "HG04155", "NA19189", "NA20827", "NA19191", "NA20909", "HG04198", "NA19196", "NA20911", "HG04162", "NA19153", "NA21089", "NA19160", "NA21091", "HG04131", "NA19172", "NA20891", "NA19211", "NA20896", "NA19223", "NA21123", "HG04186", "NA19235", "NA21128", "HG04100", "NA19139", "NA21130", "HG04206", "NA19141", "NA21104", "HG04225", "NA19146", "NA21109", "NA11891", "NA19103", "NA21111", "NA11930", "NA19108", "NA20872", "NA11992", "NA19115", "NA20877", "NA12003", "NA19247", "NA20884", "NA12046", "NA19254", "NA20889", "NA07357", "NA19204", "NA20904", "NA10831", "NA19209", "NA20858", "NA10836", "NA19312", "NA21116", "NA10843", "NA19122", "NA21135", "NA10850", "NA19127", "NA21142", "NA10855", "NA19398", "NA07340", "NA19401", "NA07345", "NA19432", "NA06993", "NA19374", "NA11839", "NA19379", "NA12748", "NA19381", "NA12750", "NA19463", "NA12762", "NA19468", "NA12414", "NA19470", "NA12546", "NA19437", "NA12717", "NA19444", "NA18486", "NA19449", "NA18498", "NA19451", "NA18501", "NA19456", "NA12767", "NA19317", "NA12801", "NA19324", "NA12813", "NA19350", "NA12058", "NA19355", "NA12154", "NA19331", "NA12248", "NA19393", "NA12344", "NA19759", "NA12375", "NA19761", "NA12399", "NA19766", "NA12274", "NA19773", "NA12286", "NA19658", "NA12818", "NA19660", "NA12832", "NA19665", "NA12875", "NA19723", "NA18506", "NA19728", "NA18518", "NA19730", "NA18520", "NA19711", "NA18619", "NA19716", "NA18621", "NA19684", "NA18626", "NA19704", "NA18525", "NA19475", "NA18532", "NA19653", "NA18537", "NA19735", "NA18544", "NA19742", "NA18570", "NA19747", "NA18582", "NA18549", "NA19672", "NA18563", "NA19677", "NA18633", "NA20282", "NA18638", "NA20287", "NA18599", "NA20294", "NA18602", "NA20299", "NA18614", "NA20302", "NA18912", "NA20314", "NA18917", "NA19778", "NA18854", "NA19780", "NA18859", "NA19785", "NA18861", "NA19918", "NA18943", "NA19920", "NA18948", "NA19982", "NA18950", "NA19836", "NA18873", "NA19901", "NA18924", "NA19913", "NA18640", "NA20319", "NA18645", "NA20321", "NA18878", "NA20333", "NA18955", "NA20340", "NA18791", "NA20345", "NA19023", "NA19792", "NA19028", "NA19030", "NA20129", "NA19004", "NA20364", "NA19009", "NA20504", "NA19011", "NA20768", "NA18981", "NA20770", "NA18986", "NA20775", "NA19054", "NA20509", "NA19059", "NA20511", "NA18962", "NA20516", "NA18967", "NA20787", "NA18993", "NA20799", "NA18998", "NA20802", "NA18974", "NA20542", "NA18979", "NA20585", "NA19035", "NA20528", "NA19042", "NA20530", "NA19066", "NA20756", "NA19198", "NA20763", "NA19201", "NA20357", "NA19206", "NA20535", "NA19117", "NA20908", "NA19129", "NA20910", "NA19131", "NA21088", "NA19143", "NA21090", "NA19148", "NA20819", "NA19092", "NA20821", "NA19097", "NA20826", "NA19213", "NA20890", "NA19225", "NA20895", "NA19078", "NA20871", "NA19080", "NA20876", "NA19085", "NA20807", "NA19150", "NA20814", "NA19100", "NA20845", "NA19105", "NA20852", "NA19174", "NA20864", "NA19186", "NA20869", "NA19434", "NA20883", "NA19439", "NA20888", "NA19446", "NA20903", "NA19256", "NA21134", "NA19307", "NA21141", "NA19314", "NA21103", "NA19319", "NA21108", "NA19321", "NA21110", "NA19383", "NA19390", "NA19395", "NA19352", "NA21122", "NA19371", "NA21127", "NA19237", "NA19249", "NA19376", "NA19338", "NA19403", "NA19679", "NA19681", "NA21115", "NA19686", "NA21095", "NA19701", "NA19472", "NA19648", "NA19650", "NA19749", "NA19751", "NA19756", "NA19713", "NA19718", "NA19720", "NA19725", "NA19655", "NA19662", "NA19732", "NA19737", "NA19453", "NA19674", "NA19787", "NA19794", "NA19819", "NA20284", "NA20289", "NA20291", "NA19984", "NA20126", "NA20277", "NA19775", "NA19782", "NA19763", "NA19770", "NA19915", "NA19922", "NA20296", "NA19908", "NA20316", "NA20335", "NA20518", "NA20520", "NA20525", "NA20544", "NA20582", "NA20587", "NA20753", "NA20758", "NA20760", "NA20361", "NA20412", "NA20347", "NA20359", "NA20506", "NA20513", "NA20765", "NA20772", "NA20532", "NA20537", "NA20342", "NA20804", "NA20809", "NA20811", "NA20816", "NA20828", "NA20859", "NA20861", "NA20866", "NA20892", "NA20897", "NA20847", "NA20854", "NA20873", "NA20878", "NA20900", "NA20905", "NA20796", "NA20885", "NA21092", "NA21097", "NA21100", "NA21112", "NA21117", "NA21124", "NA21129", "NA21143", "NA21105"]

chromosomes = ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','X','Y']

vcf_name_mask = "ALL.chrN.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz"
reference_name_mask = "Homo_sapiens.GRCh37.dna.chromosome.N.fa.gz"

#------------------------------------------------------------
def remove_file(file_path):
    os.remove(file_path)

# execute command: return True if everything OK, False otherwise
def execute_command(command):
    try:
        print("Command: {}".format(command))
        subprocess.check_output(command, shell=True)
    except subprocess.CalledProcessError:
        print("Error executing command line:")
        print("\t"+ command)
        return False
    return True


#------------------------------------------------------------

def generate_fasta(vcf_dir, vcf_name, tmp_dir, ref_name, ref_dir, fasta_dir, chromosome, sample_id):
    command = "vcf-subset -c {ind} {tmp}/{input_vcf} | bgzip -c > {tmp}/{ind}_{chr}.vcf.gz".format(vd=vcf_dir, input_vcf=vcf_name, tmp=tmp_dir, ind=sample_id, chr=chromosome)
    execute_command(command)
    command = "tabix -p vcf {tmp}/{ind}_{chr}.vcf.gz".format(tmp=tmp_dir, ind=sample_id, chr=chromosome)
    execute_command(command)
    command = "gunzip -c {rd}/{ref} | vcf-consensus -i {tmp}/{ind}_{chr}.vcf.gz > {fd}/{ind}_{chr}.fa".format(ref=ref_name, tmp=tmp_dir, ind=sample_id, chr=chromosome, fd=fasta_dir, rd=ref_dir)
    execute_command(command)


def main():
    parser = argparse.ArgumentParser(description=Description, formatter_class=argparse.RawTextHelpFormatter)
    parser.add_argument('-v', '--vcf-directory', help='Directory of vcf files', type=str, dest="vcf_dir")
    parser.add_argument('-f', '--fasta-directory', help='Directory of output fasta files', type=str, dest="fasta_dir")
    parser.add_argument('-r', '--reference-directory', help='Directory of reference file', type=str, dest="ref_dir")
    parser.add_argument('-n', '--individuals', help='Number of individuals', default=1, type=int, dest="individuals")
    parser.add_argument('-c', '--chromosome', help='Chromosome [1-23]', default=1, type=int, dest="chromosome")
    parser.add_argument('-t', '--tmp', help='Tmp files dir', default="", type=str, dest="tmp_dir")
    parser.add_argument('-j', '--jobs', help='Number of threads', default=1, type=int, dest="jobs")

    args = parser.parse_args()

    # Get the chromosome files: vcf and reference
    vcf_name = vcf_name_mask.replace("N", str(chromosomes[args.chromosome - 1]))
    ref_name = reference_name_mask.replace("N", str(chromosomes[args.chromosome - 1]))
    command = "cp {vd}/{input_vcf} {tmp}/{input_vcf}".format(vd=args.vcf_dir, input_vcf=vcf_name, tmp=args.tmp_dir)
    execute_command(command)
    command = "cp {vd}/{input_vcf}.tbi {tmp}/{input_vcf}.tbi".format(vd=args.vcf_dir, input_vcf=vcf_name, tmp=args.tmp_dir)
    execute_command(command)
    command = "tabix -h {tmp}/{input_vcf} -f".format(tmp=args.tmp_dir, input_vcf=vcf_name)
    execute_command(command)

    # Generate fasta file for the input chromosome
    pool = Pool(processes=args.jobs)
    fixed_args = [args.vcf_dir, vcf_name, args.tmp_dir, ref_name, args.ref_dir, args.fasta_dir, chromosomes[int(args.chromosome)  - 1]]
    execs = []
    for i in range(len(samples_ids)):
        execs.append(fixed_args + [samples_ids[i]])

    pool.starmap(generate_fasta, execs)




if __name__ == '__main__':
    main()





